(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-740334a1"],{"00b9":function(t,e,s){},"25f4":function(t,e,s){t.exports=s.p+"img/up-eye.41cc38c0.jpg"},"279d":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"covid-page order-layout"},[a("header",{staticClass:"page-header"},[a("div",{staticStyle:{display:"flex","align-items":"center"}},[a("router-link",{staticClass:"header-link",attrs:{to:"/index",tag:"span"}},[a("img",{staticClass:"header-icon",attrs:{src:s("a582")}})]),t._m(0),a("img",{staticClass:"header-logo1",attrs:{src:s("962b")}})],1),a("router-link",{staticClass:"header-link",attrs:{to:"/mine",tag:"span"}},[a("img",{staticClass:"header-icon",attrs:{src:s("c651")}})])],1),a("div",{staticClass:"order-title"},[t._v("\n      "+t._s(t.$t("home.title"))+"\n    ")]),a("div",{directives:[{name:"show",rawName:"v-show",value:"en"!=t.language,expression:"language != 'en'"}],staticClass:"order-tip"},[t._v("\n      THAILAND USE ONLY\n    ")]),t.uploadNeedLogin&&!t.isLogin?a("div",{staticClass:"order-content"},[a("van-button",{staticClass:"order-button",staticStyle:{"margin-top":"30px"},attrs:{size:"normal"},on:{click:t.handleLogin}},[t._v(t._s(t.$t("order.step_0_login")))])],1):t._e(),0!=t.step||t.uploadNeedLogin&&!t.isLogin?t._e():a("div",{staticClass:"order-content"},[a("van-steps",{staticClass:"multi-steps",attrs:{active:t.imgIndex,"active-color":"#ffffff","inactive-color":"#bebebe"}},[a("van-step",[t._v(t._s(t.$t("multi.img0")))]),a("van-step",[t._v(t._s(t.$t("multi.img1")))]),a("van-step",[t._v(t._s(t.$t("multi.img2")))]),a("van-step",[t._v(t._s(t.$t("multi.img3")))])],1),t.noImage?a("div",{staticClass:"order-help"},[t._v("\n        "+t._s(t.$t("order.step_0_title"))+" ("+t._s(t.$t("multi.img"+t.imgIndex))+")\n      ")]):t._e(),t.max_test_enable&&t.ip_enable&&t.noImage?a("van-uploader",{staticClass:"order-uploader",attrs:{"after-read":t.handleInput,accept:"image/*",capture:"user"}},[a("van-button",{staticClass:"order-button order-button-white",attrs:{size:"normal"}},[t._v(t._s(t.$t("order.step_0_camera")))])],1):t._e(),t.max_test_enable&&t.ip_enable||!t.noImage?t._e():a("van-button",{staticClass:"order-button order-button-white",staticStyle:{"margin-top":"30px"},attrs:{size:"normal"},on:{click:t.handleCheck}},[t._v(t._s(t.$t("order.step_0_camera")))]),t.max_test_enable&&t.ip_enable&&t.noImage?a("van-uploader",{staticClass:"order-uploader",attrs:{"after-read":t.handleInput,accept:"image/*"}},[a("van-button",{staticClass:"order-button",attrs:{size:"normal"}},[t._v(t._s(t.$t("order.step_0_choose")))])],1):t._e(),t.max_test_enable&&t.ip_enable||!t.noImage?t._e():a("van-button",{staticClass:"order-button",staticStyle:{"margin-top":"30px"},attrs:{size:"normal"},on:{click:t.handleCheck}},[t._v(t._s(t.$t("order.step_0_choose")))]),t.noImage?t._e():a("div",{staticClass:"order-reset"},[a("van-uploader",{staticClass:"order-uploader",attrs:{"after-read":t.handleInput,accept:"image/*",capture:"user"}},[a("van-button",{staticClass:"order-button",attrs:{size:"normal"}},[t._v(t._s(t.$t("order.step_1_camera")))])],1),a("van-uploader",{staticClass:"order-uploader",attrs:{"after-read":t.handleInput,accept:"image/*"}},[a("van-button",{staticClass:"order-button",attrs:{size:"normal"}},[t._v(t._s(t.$t("order.step_1_choose")))])],1)],1),a("div",{staticStyle:{"margin-top":"40px","margin-bottom":"10px"}},[a("div",{staticClass:"order-preview-image"},[a("span",{staticClass:"image-title"},[t._v(t._s(t.$t("multi.img0"))+":")]),a("img",{staticClass:"real-sample-preview",attrs:{src:s("8e34")}})]),a("div",{staticClass:"order-preview-image"},[a("span",{staticClass:"image-title"},[t._v(t._s(t.$t("multi.img1"))+":")]),a("img",{staticClass:"real-sample-preview",attrs:{src:s("e01f")}})]),a("div",{staticClass:"order-preview-image"},[a("span",{staticClass:"image-title"},[t._v(t._s(t.$t("multi.img2"))+":")]),a("img",{staticClass:"real-sample-preview",attrs:{src:s("cecd")}})]),a("div",{staticClass:"order-preview-image"},[a("span",{staticClass:"image-title"},[t._v(t._s(t.$t("multi.img3"))+":")]),a("img",{staticClass:"real-sample-preview",attrs:{src:s("25f4")}})])]),t.noImage&&0==t.imgIndex?a("div",{staticClass:"order-tip-text",staticStyle:{"margin-top":"30px"}},[t._v("\n        "+t._s(t.$t("home.alert"))),a("br"),t._v("\n        "+t._s(t.$t("multi.tip_0"))),a("br"),a("br"),t._v("\n        "+t._s(t.$t("multi.tip_1"))),a("br"),a("br"),t._v("\n        "+t._s(t.$t("multi.tip_2"))),a("br"),a("br"),t._v("\n        "+t._s(t.$t("multi.tip_3"))),a("br"),a("br"),t._v("\n        "+t._s(t.$t("multi.tip_4"))),a("br")]):t._e(),t.noImage||0!=t.imgIndex?t._e():a("div",{staticClass:"order-clip",attrs:{id:"clipArea0"}}),t.noImage||1!=t.imgIndex?t._e():a("div",{staticClass:"order-clip",attrs:{id:"clipArea1"}}),t.noImage||2!=t.imgIndex?t._e():a("div",{staticClass:"order-clip",attrs:{id:"clipArea2"}}),t.noImage||3!=t.imgIndex?t._e():a("div",{staticClass:"order-clip",attrs:{id:"clipArea3"}}),t.noImage?t._e():a("van-button",{staticClass:"order-button order-button-white",attrs:{size:"normal"},on:{click:t.handleNext}},[t._v("\n        "+t._s(t.$t("multi.next"))+"\n      ")]),t.noImage?t._e():a("div",{staticClass:"order-example-text"},[t._v("\n        "+t._s(t.$t("order.step_1_tip_0"))),a("br"),t._v("\n        "+t._s(t.$t("order.step_1_tip_1"))+"\n      ")]),t.noImage||0!=t.imgIndex?t._e():a("img",{staticClass:"order-example",attrs:{src:s("d585")}}),t.noImage||1!=t.imgIndex?t._e():a("img",{staticClass:"order-example",attrs:{src:s("f426")}}),t.noImage||2!=t.imgIndex?t._e():a("img",{staticClass:"order-example",attrs:{src:s("de67")}}),t.noImage||3!=t.imgIndex?t._e():a("img",{staticClass:"order-example",attrs:{src:s("6939")}})],1),1==t.step?a("div",{staticClass:"order-content"},[a("div",{staticClass:"order-help",staticStyle:{"margin-bottom":"20px"}},[t._v("\n        "+t._s(t.$t("order.step_2_title"))+"\n      ")]),t._l(t.uploadImage,(function(e,s){return a("div",{key:e,staticClass:"order-preview-image"},[0===s?a("span",{staticClass:"image-title"},[t._v(t._s(t.$t("multi.img0"))+":")]):t._e(),1===s?a("span",{staticClass:"image-title"},[t._v(t._s(t.$t("multi.img1"))+":")]):t._e(),2===s?a("span",{staticClass:"image-title"},[t._v(t._s(t.$t("multi.img2"))+":")]):t._e(),3===s?a("span",{staticClass:"image-title"},[t._v(t._s(t.$t("multi.img3"))+":")]):t._e(),a("img",{staticClass:"order-submit",attrs:{src:e}})])})),a("div",{staticClass:"order-prview-text"},[t._v("\n        "+t._s(t.$t("multi.step_2_tip_1"))+"\n        "),a("br"),a("br"),t._v("\n        "+t._s(t.$t("order.step_2_tip_2"))+"\n      ")]),a("div",{staticClass:"order-preview-buttons"},[a("van-button",{staticClass:"order-button order-button-white",attrs:{size:"normal",icon:"success"},on:{click:t.handleUpload}},[t._v(t._s(t.$t("order.step_2_test")))]),a("van-button",{staticClass:"order-button",attrs:{size:"normal",icon:"cross"},on:{click:t.handleReUpload}},[t._v(t._s(t.$t("order.step_2_back")))])],1)],2):t._e(),2==t.step?a("div",{staticClass:"order-content"},[a("div",{staticClass:"order-help"},[t._v("\n        "+t._s(t.$t("order.step_3_title"))+"\n      ")]),a("van-circle",{staticStyle:{"margin-top":"20px"},attrs:{rate:99,speed:20,text:t.text,"stroke-width":80,"layer-color":"#eeeeee",color:t.gradientColor,size:"150"},model:{value:t.currentCircle,callback:function(e){t.currentCircle=e},expression:"currentCircle"}})],1):t._e(),3==t.step?a("div",{staticClass:"order-content"},[a("div",{staticClass:"order-help",staticStyle:{"margin-top":"40px"}},[t._v("\n        "+t._s(t.$t("order.step_4_title"))+"\n      ")]),a("van-button",{staticClass:"order-button",staticStyle:{width:"200px","margin-top":"20px"},attrs:{size:"normal"},on:{click:t.handleReUpload}},[t._v(t._s(t.$t("order.step_5_rePredict")))])],1):t._e(),4==t.step?a("div",{staticClass:"order-content"},[a("div",{staticClass:"order-result"},[t.isNormalUser?t._e():a("div",{staticClass:"result-item"},[a("span",{staticClass:"result-label"},[t._v(t._s(t.result_healthy.label))]),a("van-circle",{attrs:{rate:t.result_healthy.prob,text:t.result_healthy.prob+"%",speed:40,"stroke-linecap":"square","stroke-width":100,"layer-color":"#eeeeee",color:t.gradientColorHealthy,size:"100"},model:{value:t.result_healthy.prob,callback:function(e){t.$set(t.result_healthy,"prob",e)},expression:"result_healthy.prob"}})],1),a("div",{staticClass:"result-item"},[a("span",{staticClass:"result-title"},[t._v("COVID-19")]),t.cv19_low_risk?a("span",{staticClass:"result-label"},[t._v(t._s(t.$t("order.step_5_low")))]):t._e(),t.cv19_low_risk?t._e():a("span",{staticClass:"result-label result-label-high"},[t._v(t._s(t.$t("order.step_5_high")))]),a("van-circle",{attrs:{rate:t.result_cv19.prob,text:t.result_cv19.prob+"%",speed:40,"stroke-linecap":"square","stroke-width":100,"layer-color":"#eeeeee",color:t.gradientColorCV19,size:"150"},model:{value:t.result_cv19.prob,callback:function(e){t.$set(t.result_cv19,"prob",e)},expression:"result_cv19.prob"}}),t.cv19_low_risk?t._e():a("div",{staticClass:"dialog-content"},[a("span",{staticStyle:{color:"red","font-weight":"bold"}},[t._v(t._s(t.$t("order.high_risk_tip_0")))]),a("span",{staticStyle:{color:"red"}},[t._v(t._s(t.$t("order.high_risk_tip_1")))])])],1),t.isNormalUser?t._e():a("div",{staticClass:"result-item"},[a("span",{staticClass:"result-label"},[t._v(t._s(t.result_pulmonary.label))]),a("van-circle",{attrs:{rate:t.result_pulmonary.prob,text:t.result_pulmonary.prob+"%",speed:40,"stroke-linecap":"square","stroke-width":100,"layer-color":"#eeeeee",color:t.gradientColorCV19,size:"100"},model:{value:t.result_pulmonary.prob,callback:function(e){t.$set(t.result_pulmonary,"prob",e)},expression:"result_pulmonary.prob"}})],1),t.isNormalUser?t._e():a("div",{staticClass:"result-item"},[a("span",{staticClass:"result-label"},[t._v(t._s(t.result_ocular.label))]),a("van-circle",{attrs:{rate:t.result_ocular.prob,text:t.result_ocular.prob+"%",speed:40,"stroke-linecap":"square","stroke-width":100,"layer-color":"#eeeeee",color:t.gradientColorCV19,size:"100"},model:{value:t.result_ocular.prob,callback:function(e){t.$set(t.result_ocular,"prob",e)},expression:"result_ocular.prob"}})],1)]),a("van-button",{staticClass:"order-button",attrs:{size:"normal"},on:{click:t.handleReUpload}},[t._v(t._s(t.$t("order.step_5_rePredict")))])],1):t._e(),a("van-dialog",{attrs:{showCancelButton:!1,showConfirmButton:!1},model:{value:t.showIpDisable,callback:function(e){t.showIpDisable=e},expression:"showIpDisable"}},[a("div",{staticClass:"dialog-content"},[t._v(t._s(t.$t("home.check_ip_enable")))])]),a("van-dialog",{attrs:{showCancelButton:!1,showConfirmButton:!1},model:{value:t.showMaxTestDisable,callback:function(e){t.showMaxTestDisable=e},expression:"showMaxTestDisable"}},[a("div",{staticClass:"dialog-content"},[t._v(t._s(t.$t("home.check_max_test")))])])],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{staticClass:"header-link",staticStyle:{"margin-left":"0.3rem"},attrs:{href:"http://aimomics.org/"}},[a("img",{staticClass:"header-logo",attrs:{src:s("a1d8")}})])}],r=(s("6b54"),s("87b3"),s("6d67"),s("c5f6"),s("28a5"),s("ac6a"),s("f3e2"),s("ca00")),l=s("12cb"),o=s("ba9f"),n=s("1365"),c=s.n(n),u={name:"home",data:function(){return{submitLoading:!1,submitSuccess:!1,uploadNeedLogin:!1,isLogin:Object(r["a"])(),language:Object(l["b"])(),isNormalUser:Object(r["f"])(),step:0,imgIndex:0,noImage:!0,currentCircle:0,circleInterval:null,photoClips:[null,null,null,null],uploadImage:[null,null,null,null],gradientColor:{"0%":"#3fecff","100%":"#6149f6"},gradientColorHealthy:{"0%":"#07c160","50%":"#ff976a","100%":"#ee0a24"},gradientColorCV19:{"0%":"#07c160","50%":"#ff976a","100%":"#ee0a24"},maxImageSize:4194304,result_healthy:{label:"Healthy",prob:"0"},result_cv19:{label:"CV19",prob:"0"},result_pulmonary:{label:"Pulmonary",prob:"0"},result_ocular:{label:"Ocular",prob:"0"},ip_enable:!0,max_test_enable:!0,showIpDisable:!1,showMaxTestDisable:!1,showHighRisk:!1,extra_order_tip:null,extra_order_tip_form:{},extra_order_tip_show:!1,extra_order_tip_columns:[],handleSubmitExtraLoading:!1,needSubmitForm:!1,order_id:null,cur_select_index:0}},computed:{text:function(){return this.currentCircle.toFixed(0)+"%"},cv19_low_risk:function(){return!(parseFloat(this.result_cv19.prob)>=50)}},created:function(){this.checkNeedLogin(),this.checkIpEnable(),this.checkMaxTest()},methods:{checkNeedLogin:function(){var t=this;this.$http.get("/api/property/all").then((function(e){0==e.data.code&&e.data.data.forEach((function(e){if("UPLOAD_NEED_LOGIN"==e.property)t.uploadNeedLogin=e.is_active;else if("ORDER_TIP"==e.property){if(""!==e.extra&&null!=e.extra){var s=JSON.parse(e.extra);s.forEach((function(e,s){e.options=null!=e.options?e.options.split(";"):[],e.options_hk=null!=e.options_hk?e.options_hk.split(";"):[],e.options_en=null!=e.options_en?e.options_en.split(";"):[],t.extra_order_tip_form[s]=null})),t.extra_order_tip=s}e.is_active?t.needSubmitForm=!0:t.needSubmitForm=!1}}))}))},orderTipOnOpen:function(t,e){this.extra_order_tip_columns="zh"===this.language?this.extra_order_tip[e].options:"hk"===this.language?this.extra_order_tip[e].options_hk:this.extra_order_tip[e].options_en,this.cur_select_index=e,this.extra_order_tip_show=!0},orderTipOnConfirm:function(t){this.extra_order_tip_form[this.cur_select_index]=t,this.extra_order_tip_columns=[],this.extra_order_tip_show=!1},checkIpEnable:function(){var t=this;this.$http.get("/api/order/check_ip_enable").then((function(e){0==e.data.code&&(t.ip_enable=e.data.data.enable)}))},checkMaxTest:function(){var t=this;this.$http.get("/api/order/check_max_test").then((function(e){0==e.data.code&&(t.max_test_enable=e.data.data.enable)}))},handleCheck:function(t){t.preventDefault(),this.ip_enable?this.max_test_enable||(this.showMaxTestDisable=!0):this.showIpDisable=!0},handleInput:function(t){var e=this;this.noImage=!1,this.$forceUpdate();var s=this.imgIndex;setTimeout((function(){null!=e.photoClips[s]&&(e.photoClips[s].destroy(),e.photoClips[s]=null),e.photoClips[s]=new c.a("#clipArea"+s,{size:[285,75],outputSize:[950,250],maxZoom:2,rotateFree:!0,outputQuality:.96,lrzOption:{width:3e3,height:2e3,quality:1}}),e.photoClips[s].load(t.file)}))},handleUpload:function(){var t=this;if(!this.submitLoading){for(var e=0;e<this.uploadImage.length;e++)if(null==this.uploadImage[e])return void this.$toast({mask:!1,message:this.$t("multi.uploadMissing")+"("+this.$t("multi.img"+e)+")"});this.submitLoading=!0,this.submitSuccess=!1,this.currentCircle=0,this.step=2;var s=new FormData;s.append("type","2"),null!=localStorage.getItem("uuid")&&s.append("uuid",localStorage.getItem("uuid")),null!=localStorage.getItem("region")&&s.append("region",localStorage.getItem("region"));for(var a=function(e){var a=Object(r["c"])(t.uploadImage[e],"covid"+e+".jpg");a.size>t.maxImageSize?o["compressAccurately"](a,t.maxImageSize/1024).then((function(t){s.append("img"+e,t)})):s.append("img"+e,a)},i=0;i<this.uploadImage.length;i++)a(i);this.circleInterval=setInterval((function(){t.currentCircle<99?t.currentCircle++:t.currentCircle>=99&&t.submitSuccess&&(t.currentCircle=100,t.needSubmitForm?t.step=4:t.step=5,clearInterval(t.circleInterval))}),50),setTimeout((function(){t.upload(s)}),1e3)}},handleReUpload:function(){this.step=0,this.imgIndex=0,this.noImage=!0,this.checkMaxTest(),this.checkIpEnable(),this.destroyClips()},destroyClips:function(){this.photoClips.forEach((function(t){null!=t&&t.destroy()})),this.photoClips=[null,null,null,null],this.uploadImage=[null,null,null,null]},upload:function(t){var e=this;this.$http.post("/api/order/check",t,{timeout:12e4}).then((function(t){if(0==t.data.code){e.submitSuccess=!0;var s=t.data.data;e.result_healthy.prob=Number(s.healthy),e.result_cv19.prob=Number(s.cv19),e.result_pulmonary.prob=Number(s.pulmonary),e.result_ocular.prob=Number(s.ocular),e.order_id=s.id,null!=s.uuid&&localStorage.setItem("uuid",s.uuid),!e.needSubmitForm&&parseFloat(e.result_cv19.prob)>=50&&(e.showHighRisk=!0),e.$http.post("/api/record/send",{event:"multi_test",message:"高级检测成功",user_name:localStorage.getItem("uuid")||null}),e.submitLoading=!1}else e.$http.post("/api/record/send",{event:"multi_test",message:"高级检测失败",user_name:localStorage.getItem("uuid")||null}),clearInterval(e.circleInterval),e.currentCircle=0,e.submitSuccess=!1,e.submitLoading=!1,e.step=3})).catch((function(t){clearInterval(e.circleInterval),e.currentCircle=0,e.submitSuccess=!1,e.submitLoading=!1,e.step=3}))},handleSubmitExtra:function(){var t=this;if(!this.handleSubmitExtraLoading){var e={order_id:this.order_id,extra:""};this.isLogin?e.user_id=localStorage.getItem("user").uid:e.uuid=localStorage.getItem("uuid"),e.extra=JSON.stringify(this.extra_order_tip.map((function(e,s){return{key:"zh"===t.language?e.title:"hk"===t.language?e.title_hk:e.title_en,value:t.extra_order_tip_form[s]}}))),this.$http.post("/api/order/updateExtra",e).then((function(e){0==e.data.code?(t.step=5,parseFloat(t.result_cv19.prob)>=50&&(t.showHighRisk=!0)):t.$toast({mask:!1,message:"Submit Error"})})).catch((function(e){t.$toast({mask:!1,message:"Submit Error"})}))}},handleLogin:function(){this.$router.push("/login")},parseInt:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t){return parseInt(t)})),handlePre:function(){this.imgIndex>0&&this.imgIndex--},handleNext:function(){this.imgIndex<3?(this.noImage=!0,this.uploadImage[this.imgIndex]=this.photoClips[this.imgIndex].clip(),this.photoClips[this.imgIndex].destroy(),this.imgIndex++):(this.uploadImage[this.imgIndex]=this.photoClips[this.imgIndex].clip(),this.photoClips[this.imgIndex].destroy(),this.photoClips=[null,null,null,null],this.step=1)}},destroyed:function(){null!=this.circleInterval&&clearInterval(this.circleInterval),this.destroyClips()}},p=u,d=(s("facc"),s("723d"),s("2877")),_=Object(d["a"])(p,a,i,!1,null,null,null);e["default"]=_.exports},6939:function(t,e,s){t.exports=s.p+"img/eye_up.c2ae5a9d.jpg"},"723d":function(t,e,s){"use strict";var a=s("00b9"),i=s.n(a);i.a},"8e34":function(t,e,s){t.exports=s.p+"img/forward-eye.3f82d6f7.jpg"},cecd:function(t,e,s){t.exports=s.p+"img/right-eye.c6c4a947.jpg"},de67:function(t,e,s){t.exports=s.p+"img/eye_right.24aaf3c0.jpg"},e01f:function(t,e,s){t.exports=s.p+"img/left-eye.fd3931a7.jpg"},f02c:function(t,e,s){},f426:function(t,e,s){t.exports=s.p+"img/eye_left.09bceed0.jpg"},facc:function(t,e,s){"use strict";var a=s("f02c"),i=s.n(a);i.a}}]);
//# sourceMappingURL=chunk-740334a1.fe70d5e5.js.map